{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "StorageWatch Agent Configuration Schema",
  "description": "Configuration schema for StorageWatch Agent instances that monitor disk space and report to central server or local database",
  "type": "object",
  "properties": {
    "StorageWatch": {
      "type": "object",
      "properties": {
        "Mode": {
          "type": "string",
          "description": "Operational mode for this instance: Standalone, Agent, or Server",
          "enum": [ "Standalone", "Agent", "Server" ],
          "default": "Standalone"
        },
        "Monitoring": {
          "type": "object",
          "description": "Disk monitoring configuration",
          "properties": {
            "ThresholdPercent": {
              "type": "integer",
              "description": "Threshold percentage of free space before alerting",
              "minimum": 0,
              "maximum": 100,
              "default": 10
            },
            "Drives": {
              "type": "array",
              "description": "List of drive letters to monitor (e.g., ['C:', 'D:'])",
              "items": {
                "type": "string"
              },
              "default": [ "C:" ]
            }
          },
          "required": [ "ThresholdPercent", "Drives" ]
        },
        "Alerting": {
          "type": "object",
          "description": "Alert notification configuration",
          "properties": {
            "EnableNotifications": {
              "type": "boolean",
              "description": "Enable or disable alert notifications",
              "default": true
            },
            "Smtp": {
              "type": "object",
              "description": "SMTP email configuration for alerts",
              "properties": {
                "Enabled": {
                  "type": "boolean",
                  "default": false
                },
                "Host": {
                  "type": "string",
                  "default": "smtp.gmail.com"
                },
                "Port": {
                  "type": "integer",
                  "default": 587
                },
                "UseSsl": {
                  "type": "boolean",
                  "default": true
                },
                "Username": {
                  "type": "string",
                  "default": ""
                },
                "Password": {
                  "type": "string",
                  "default": ""
                },
                "FromAddress": {
                  "type": "string",
                  "default": ""
                },
                "ToAddress": {
                  "type": "string",
                  "default": ""
                }
              },
              "required": [ "Enabled" ]
            },
            "GroupMe": {
              "type": "object",
              "description": "GroupMe bot configuration for alerts",
              "properties": {
                "Enabled": {
                  "type": "boolean",
                  "default": false
                },
                "BotId": {
                  "type": "string",
                  "default": ""
                }
              },
              "required": [ "Enabled" ]
            }
          },
          "required": [ "EnableNotifications" ]
        },
        "SqlReporting": {
          "type": "object",
          "description": "SQL database reporting configuration",
          "properties": {
            "Enabled": {
              "type": "boolean",
              "description": "Enable or disable SQL database reporting",
              "default": true
            },
            "RunMissedCollection": {
              "type": "boolean",
              "description": "Execute missed collection runs as soon as possible",
              "default": true
            },
            "RunOnlyOncePerDay": {
              "type": "boolean",
              "description": "Restrict collection to once per day",
              "default": true
            },
            "CollectionTime": {
              "type": "string",
              "description": "Daily time to execute collection (HH:mm format)",
              "pattern": "^([0-1][0-9]|2[0-3]):[0-5][0-9]$",
              "default": "02:00"
            }
          },
          "required": [ "Enabled" ]
        },
        "CentralServer": {
          "type": "object",
          "description": "Central server configuration for agent or server mode",
          "properties": {
            "Enabled": {
              "type": "boolean",
              "description": "Enable central server functionality",
              "default": false
            },
            "Mode": {
              "type": "string",
              "description": "Role for this instance: Agent or Server",
              "enum": [ "Agent", "Server" ],
              "default": "Agent"
            },
            "ServerUrl": {
              "type": "string",
              "description": "URL of the central server (Agent mode)",
              "default": ""
            },
            "BaseUrl": {
              "type": "string",
              "description": "Alias for ServerUrl",
              "default": ""
            },
            "ApiKey": {
              "type": "string",
              "description": "Optional API key for authentication",
              "default": ""
            },
            "AgentId": {
              "type": "string",
              "description": "Unique identifier for this agent",
              "default": ""
            },
            "ReportIntervalSeconds": {
              "type": "integer",
              "description": "Interval in seconds between reports",
              "minimum": 1,
              "maximum": 86400,
              "default": 300
            },
            "ReportingIntervalSeconds": {
              "type": "integer",
              "description": "Alias for ReportIntervalSeconds",
              "minimum": 1,
              "maximum": 86400,
              "default": 300
            },
            "Port": {
              "type": "integer",
              "description": "Port for server mode",
              "minimum": 1,
              "maximum": 65535,
              "default": 5000
            },
            "CentralConnectionString": {
              "type": "string",
              "description": "SQLite connection string for central server database",
              "default": ""
            },
            "ServerId": {
              "type": "string",
              "description": "Identifier for this central server instance",
              "default": "central-server"
            }
          },
          "required": [ "Enabled", "Mode" ]
        }
      },
      "required": [ "Mode", "Monitoring", "Alerting", "SqlReporting", "CentralServer" ]
    }
  },
  "required": ["StorageWatch"]
}
